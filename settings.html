<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings</title>
    <link rel="stylesheet" href="style/style.css">
    <link rel="stylesheet" href="style/palette.css">
    <link rel="stylesheet" href="style/containers.css">
    <link rel="stylesheet" href="style/inputs.css">
    <link rel="shortcut icon" href="resource/brading/light-tiny.png" type="image/x-icon">
</head>

<body>
    <input type="text" id="list-title" class="title-box" hidden>
    <div id="list" class="todo-list" hidden></div>
    <div class="document">
        <a href="index.html"><span class="icon">arrow_back</span> Go back</a>
        <h1>Settings</h1>
        <h2>Look and feel</h2>
        <!-- color palette -------------------------------------------------------------------------->
        <details name="setting">
            <summary>
                <span class="center-flex"><span class="large-icon">palette</span>Color palette</span>
                <div>
                    <button class="text-button" onclick="savePalette()">Update</button>
                </div>
            </summary>

            <!-- Theme Selector -->
            <div class="center-flex">
                <select id="theme-selector" onchange="applySelectedTheme()">
                    <option value="">Select a theme preset</option>
                    <option value="" disabled>__ Dark ___________________________________</option>
                    <option value="kitten">Kitten (Default)</option>
                    <option value="cyberpunk">Cyberpunk</option>
                    <option value="github-dark">GitHub Dark</option>
                    <option value="monokai">Monokai</option>
                    <option value="oled">OLED</option>

                    <option value="" disabled>__ Light __________________________________</option>
                    <option value="github-light">GitHub Light</option>
                    <option value="ocean-breeze">Ocean Breeze</option>
                    <option value="sakura-blossom">Sakua Blossom</option>

                    <option value="" disabled>__ Special ________________________________</option>
                    <option value="hatsune-miku">Hatsune Miku</option>
                    <option value="kasane-teto">Kasane Teto</option>
                </select>
            </div>

            <!-- Color Inputs -->
            <div class="center-flex">
                <input type="color" value="#242424" name="--background-color" id="--background-color">
                <label for="--background-color">Background color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#393939" name="--card-color" id="--card-color">
                <label for="--card-color">Card color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#464646" name="--field-color" id="--field-color">
                <label for="--field-color">Field color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#666666" name="--border-color" id="--border-color">
                <label for="--border-color">Border color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#cccccc" name="--text-color" id="--text-color">
                <label for="--text-color">Text color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#ffffff" name="--icon-color" id="--icon-color">
                <label for="--icon-color">Icon color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#ffffff" name="--title-color" id="--title-color">
                <label for="--title-color">Title color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#50d3ff" name="--highlight-color" id="--highlight-color">
                <label for="--highlight-color">Highlight color</label>
            </div>
            <div class="center-flex">
                <input type="color" value="#ff7474" name="--warning-color" id="--warning-color">
                <label for="--warning-color">Warning color</label>
            </div>
        </details>

        <!-- fonts ---------------------------------------------------------------------------------->
        <details name="setting">
            <summary>
                <span class="center-flex"><span class="large-icon">brand_family</span>Font</span>
                <div>
                    <button class="text-button" onclick="resetFont()">Reset</button>
                </div>
            </summary>
            <label for="--font">Typeface</label><br>
            <input type="text" value="Segoe UI" name="--font" id="--font" oninput="saveFont()"><br>
            <label for="--font-size">Size</label><br>
            <input type="range" name="--font-size" id="--font-size" min="0.5" max="1.5" value="1" step="0.1"
                oninput="saveFont()">
        </details>

        <!-- wallpaper ------------------------------------------------------------------------------>
        <details name="setting">
            <summary>
                <span class="center-flex"><span class="large-icon">wallpaper</span>Wallpaper</span>
                <div>
                    <button class="text-button" onclick="resetWallpaper()">Reset</button>
                </div>
            </summary>
            <label for="--wallpaper">URL</label><br>
            <input type="url" name="--wallpaper" id="--wallpaper" oninput="saveWallpaper()"><br>
            <label for="--wallpaper-blur">Blur</label><br>
            <input type="range" name="--wallpaper-blur" id="--wallpaper-blur" min="0" max="10" value="0"
                oninput="saveWallpaper()"><br>
            <label for="--wallpaper-brightness">Brightness</label><br>
            <input type="range" name="--wallpaper-brightness" id="--wallpaper-brightness" min="0" max="2" value="1"
                step="0.1" oninput="saveWallpaper()"><br>
        </details>

        <hr>

        <h2>Data</h2>
        <!-- my task list --------------------------------------------------------------------------->
        <details name="setting">
            <summary><span class="center-flex"><span class="large-icon">checklist</span>My task list</span></summary>
            <button class="text-button" onclick="exportTasks()">Export Markdown</button>
            <button class="text-button">
                <label for="import-file" style="cursor: pointer;">Import Markdown</label>
                <input type="file" id="import-file" style="display: none;" onchange="importTasks(event)">
            </button>
            <button class="danger-button" data-action="clearTasks()" title="Clear todo list [hold]">Clear</button>
        </details>

        <hr>

        <h2>About</h2>
        <details name="setting">
            <summary><span class="center-flex"><span class="large-icon">info</span>About Kitten</span></summary>
            <div class="center-flex break-on-mobile">
                <img src="resource/brading/light-full.png" width="50%" alt="">
                <div>
                    <h3>Kitten</h3>
                    <p>Kitten is an <b>accountless</b>, <b>free</b> and <b>opensource</b> tasklist manager.</p>
                    <ul>
                        <li><a href="https://github.com/flarom/kitten/blob/main/README.md">Documentation</a></li>
                        <li><a href="https://github.com/flarom/kitten/">GitHub Repository</a></li>
                    </ul>
                </div>
            </div>
        </details>

        <script src="script/settings.js"></script>
        <script src="script/todo.js"></script>
        <script src="script/dangerbuttons.js"></script>
        <script>
            function applySelectedTheme() {
                const themeSelector = document.getElementById('theme-selector');
                const selectedTheme = themeSelector.value;

                const themes = {
                    'kitten': {
                        '--background-color': '#242424',
                        '--card-color': '#393939',
                        '--field-color': '#464646',
                        '--border-color': '#666666',
                        '--text-color': '#cccccc',
                        '--icon-color': '#ffffff',
                        '--title-color': '#ffffff',
                        '--highlight-color': '#50d3ff',
                        '--warning-color': '#ff7474'
                    },
                    'github-dark': {
                        '--background-color': '#0d1117',
                        '--card-color': '#161b22',
                        '--field-color': '#21262d',
                        '--border-color': '#30363d',
                        '--text-color': '#c9d1d9',
                        '--icon-color': '#f0f6fc',
                        '--title-color': '#f0f6fc',
                        '--highlight-color': '#58a6ff',
                        '--warning-color': '#f85149'
                    },
                    'github-light': {
                        '--background-color': '#ffffff',
                        '--card-color': '#f6f8fa',
                        '--field-color': '#eaeef2',
                        '--border-color': '#d0d7de',
                        '--text-color': '#24292f',
                        '--icon-color': '#1b1f23',
                        '--title-color': '#1b1f23',
                        '--highlight-color': '#0969da',
                        '--warning-color': '#cf222e'
                    },
                    'monokai': {
                        '--background-color': '#272822',
                        '--card-color': '#3e3d32',
                        '--field-color': '#49483e',
                        '--border-color': '#75715e',
                        '--text-color': '#f8f8f2',
                        '--icon-color': '#f8f8f0',
                        '--title-color': '#f8f8f0',
                        '--highlight-color': '#a6e22e',
                        '--warning-color': '#f92672'
                    },
                    'cyberpunk': {
                        '--background-color': '#0f0f1a',
                        '--card-color': '#1a1a2e',
                        '--field-color': '#2e2e3f',
                        '--border-color': '#44475a',
                        '--text-color': '#f8f8f2',
                        '--icon-color': '#ff79c6',
                        '--title-color': '#bd93f9',
                        '--highlight-color': '#50fa7b',
                        '--warning-color': '#ff5555'
                    },
                    'sakura-blossom': {
                        '--background-color': '#fff4f6',
                        '--card-color': '#ffe4ec',
                        '--field-color': '#ffccd9',
                        '--border-color': '#ff99aa',
                        '--text-color': '#4b2c3f',
                        '--icon-color': '#e91e63',
                        '--title-color': '#ad1457',
                        '--highlight-color': '#f48fb1',
                        '--warning-color': '#d81b60'
                    },
                    'ocean-breeze': {
                        '--background-color': '#e0f7fa',
                        '--card-color': '#b2ebf2',
                        '--field-color': '#80deea',
                        '--border-color': '#4dd0e1',
                        '--text-color': '#004d40',
                        '--icon-color': '#006064',
                        '--title-color': '#00796b',
                        '--highlight-color': '#00bcd4',
                        '--warning-color': '#d32f2f'
                    },
                    'oled': {
                        '--background-color': '#000000',
                        '--card-color': '#121212',
                        '--field-color': '#1a1a1a',
                        '--border-color': '#1f1f1f',
                        '--text-color': '#e0e0e0',
                        '--icon-color': '#00ffcc',
                        '--title-color': '#00ffaa',
                        '--highlight-color': '#00ff88',
                        '--warning-color': '#ff4444'
                    },
                    'hatsune-miku': {
                        '--background-color': '#1b1f27',
                        '--card-color': '#22303c',
                        '--field-color': '#2e3b4e',
                        '--border-color': '#39c0ba',
                        '--text-color': '#b2fefe',
                        '--icon-color': '#00ffe0',
                        '--title-color': '#00e0c6',
                        '--highlight-color': '#39c5bb',
                        '--warning-color': '#ff5e80'
                    },
                    'kasane-teto': {
                        '--background-color': '#2b0d0d',
                        '--card-color': '#3a1414',
                        '--field-color': '#551919',
                        '--border-color': '#ff4d4d',
                        '--text-color': '#ffeaea',
                        '--icon-color': '#ff9999',
                        '--title-color': '#ff3c3c',
                        '--highlight-color': '#ff5e5e',
                        '--warning-color': '#ff1f1f'
                    }
                };

                const theme = themes[selectedTheme];
                if (theme) {
                    for (const [key, value] of Object.entries(theme)) {
                        saveColor(key, value);
                        document.documentElement.style.setProperty(key, value);
                    }

                    const highlightColor = theme['--highlight-color'];
                    const warningColor = theme['--warning-color'];

                    saveItem('--highlight-back', `${highlightColor}44`);
                    saveItem('--warning-back', `${warningColor}44`);
                    document.documentElement.style.setProperty('--highlight-back', `${highlightColor}44`);
                    document.documentElement.style.setProperty('--warning-back', `${warningColor}44`);
                }
            }

            function saveColor(property, value) {
                saveItem(property, value);

                const colorInput = document.getElementById(property);
                if (colorInput) {
                    colorInput.value = value;
                }
            }

            function savePalette() {
                const colors = [
                    '--background-color',
                    '--card-color',
                    '--field-color',
                    '--border-color',
                    '--text-color',
                    '--icon-color',
                    '--title-color',
                    '--highlight-color',
                    '--warning-color'
                ];

                colors.forEach(color => {
                    const input = document.getElementById(color);
                    if (input) {
                        saveColor(color, input.value);
                    }
                });

                const highlightColor = document.getElementById('--highlight-color').value;
                const warningColor = document.getElementById('--warning-color').value;

                saveItem('--highlight-back', `${highlightColor}44`);
                saveItem('--warning-back', `${warningColor}44`);
            }
            function loadPaletteIntoInputs() {
                const colors = [
                    '--background-color',
                    '--card-color',
                    '--field-color',
                    '--border-color',
                    '--text-color',
                    '--icon-color',
                    '--title-color',
                    '--highlight-color',
                    '--warning-color'
                ];

                colors.forEach(color => {
                    const savedValue = loadItem(color);
                    const input = document.getElementById(color);
                    if (savedValue) {
                        input.value = savedValue;
                    }
                });
            }
            loadPaletteIntoInputs();

            const fontInput = document.getElementById("--font");
            const fontSizeInput = document.getElementById("--font-size");
            fontInput.value = loadItem('--font');
            fontSizeInput.value = loadItem('--font-size');

            function saveFont() {
                saveItem('--font', fontInput.value);
                saveItem('--font-size', fontSizeInput.value);
            }

            function resetFont() {
                removeItem('--font');
                removeItem('--font-size');
                fontInput.value = "";
                fontSizeInput.value = "1";
            }

            const wallpaperInput = document.getElementById("--wallpaper");
            let storedWallpaper = loadItem('--wallpaper');
            if (storedWallpaper?.startsWith("url('") && storedWallpaper.endsWith("')")) {
                storedWallpaper = storedWallpaper.slice(5, -2);
            }
            wallpaperInput.value = storedWallpaper || "";

            const wallpaperBlurInput = document.getElementById("--wallpaper-blur");
            let storedWallpaperBlur = loadItem('--wallpaper-blur');
            if (storedWallpaperBlur?.endsWith("px")) {
                storedWallpaperBlur = storedWallpaperBlur.slice(0, -2);
            }
            wallpaperBlurInput.value = storedWallpaperBlur || 0;

            const wallpaperBrightnessInput = document.getElementById("--wallpaper-brightness");
            wallpaperBrightnessInput.value = loadItem('--wallpaper-brightness');

            function saveWallpaper() {
                saveItem('--wallpaper', `url('${wallpaperInput.value}')`);
                saveItem('--wallpaper-blur', `${wallpaperBlurInput.value}px`);
                saveItem('--wallpaper-brightness', wallpaperBrightnessInput.value);
            }

            function resetWallpaper() {
                removeItem('--wallpaper');
                removeItem('--wallpaper-blur');
                removeItem('--wallpaper-brightness');
                wallpaperInput.value = "";
            }
        </script>
    </div>
</body>

</html>